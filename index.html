<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>MK Telegram Mini App</title>

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- TON Connect -->
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
</head>

<body>

  <!-- Ğ—ĞĞ“ĞĞ›ĞĞ’ĞĞš -->
  <h1>ğŸš€ MK</h1>
  <p>Telegram Mini App</p>

  <!-- Ğ‘ĞĞ›ĞĞĞ¡ -->
  <p>ğŸ’° Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: <span id="balance">0</span> MK</p>

  <!-- ĞšĞĞĞŸĞšĞ Ğ”ĞĞĞĞ¢Ğ -->
  <button onclick="donateTON()">ğŸ’ Ğ”Ğ¾Ğ½Ğ°Ñ‚ TON</button>

  <!-- TON CONNECT -->
  <div id="ton-connect"></div>
  <p id="wallet"></p>

  <!-- JS Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ’ ĞšĞĞĞ¦Ğ• BODY -->
  <script>
    const tg = Telegram.WebApp;
    tg.expand();

    // ===== Ğ‘ĞĞ›ĞĞĞ¡ =====
    let balance = localStorage.getItem("mk_balance");
    if (!balance) {
      balance = 0;
      localStorage.setItem("mk_balance", balance);
    }
    document.getElementById("balance").innerText = balance;

    function addBalance(amount) {
      balance = parseInt(balance) + amount;
      localStorage.setItem("mk_balance", balance);
      document.getElementById("balance").innerText = balance;
    }

    // ===== DONATE TON =====
    function donateTON() {
      const address = "UQBOekw_iNJGJNSZgTZkHTjOB_FqsGOOS_VG8n0oQzwitABM"; 
      const tonAmount = 0.5;

      const tonLink = ton://transfer/${address}?amount=${tonAmount * 1e9};
      window.open(tonLink, "_blank");

      // 1 TON = 100 MK (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€)
      addBalance(50);
    }

    // ===== TON CONNECT =====
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: "https://mk-app.vercel.app/tonconnect-manifest.json"
    });

    tonConnectUI.render({
      container: document.getElementById("ton-connect")
    });

    tonConnectUI.onStatusChange(wallet => {
      if (wallet) {
        document.getElementById("wallet").innerText =
          "ĞšĞ¾ÑˆĞµĞ»Ñ‘Ğº Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½: " + wallet.account.address;
      }
    });
  </script>

</body>
  </html>
